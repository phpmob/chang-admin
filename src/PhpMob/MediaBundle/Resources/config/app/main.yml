parameters:
    phpmob.imagine.loader: default
    phpmob.uploader.local_directory: "%kernel.root_dir%/../var/media"
    phpmob.flysystem.cache_adapter: "cache.app"

imports:
    - { resource: "@PhpMobMediaBundle/Resources/config/app/fm_elfinder.yml" }

doctrine:
    dbal:
        types:
            phpmob_image_type: PhpMob\MediaBundle\Doctrine\DBAL\Type\ImageType

liip_imagine:
    loaders:
        default:
            filesystem:
                data_root:
                    - "%phpmob.uploader.local_directory%"
    filter_sets:
        strip:
            quality: "%phpmob.imagine.quality%"
            data_loader: "%phpmob.imagine.loader%"
            filters: ~
        phpmob_imagine:
            quality: "%phpmob.imagine.quality%"
            data_loader: "%phpmob.imagine.loader%"
            filters: ~

twig:
    form_themes:
        - "@PhpMobMedia/form.html.twig"
    globals:
        phpmob_imagine:
            form_default_image_preview: "%phpmob.imagine.form_default_image%"

framework:
    cache:
        pools:
            cache.flysystem:
                adapter: "%phpmob.flysystem.cache_adapter%"

oneup_flysystem:
    cache:
        phpmob_cache:
            psr6:
                service: cache.flysystem
                key: phpmob_media
                expires: ~
    adapters:
        phpmob_local:
            local:
                directory: "%phpmob.uploader.local_directory%"
    filesystems:
        phpmob:
            adapter: phpmob_local
            #https://github.com/thephpleague/flysystem-cached-adapter/issues/29
            #cache: phpmob_cache
